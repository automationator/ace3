# [bro]
# the directory that contains the HTTP streams generated by bro/ace_http.bro (relative to DATA_DIR)
bro:
  http_dir: var/bro/http
  # the directory that contains the SMTP streams generated by bro/ace_smtp.bro (relative to DATA_DIR)
  smtp_dir: var/bro/smtp

# [config]
config:
  bro_local: etc/saq.bro.yaml

# [service_bro_http_collector]
service_bro_http_collector:
  module: saq.collectors.http
  class: BroHTTPStreamCollector
  description: Bro HTTP Stream Collector - collects HTTP stream data from bro (zeek) running ACE modules
  enabled: true
  workload_type: http

# [service_bro_smtp_collector]
service_bro_smtp_collector:
  module: saq.collectors.smtp
  class: BroSMTPStreamCollector
  description: Bro SMTP Stream Collector - collects SMTP stream data from bro (zeek) running ACE modules
  enabled: true

# [analysis_module_bro_smtp_analyzer]
analysis_module_bro_smtp_analyzer:
  id: bro_smtp_analyzer
  module: saq.modules.email.zeek
  class: BroSMTPStreamAnalyzer
  enabled: true

# [analysis_module_bro_http_analyzer]
analysis_module_bro_http_analyzer:
  id: bro_http_analyzer
  module: saq.modules.http
  class: BroHTTPStreamAnalyzer
  enabled: true
  # path to the brotex custom whitelist file
  whitelist_path: etc/brotex.whitelist

# [module_group_email]
module_group_email:
  analysis_module_bro_smtp_analyzer: true

# [analysis_mode_http]
analysis_mode_http:
  # mode used for HTTP stream analysis
  module_groups:
    - common
    - file
  cleanup: true
  analysis_module_bro_http_analyzer: true
  maximum_cumulative_analysis_warning_time: 30
  maximum_cumulative_analysis_fail_time: 120
  maximum_analysis_time: 20
